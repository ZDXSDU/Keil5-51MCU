C51 COMPILER V9.60.7.0   DS1302                                                            08/15/2023 17:06:57 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE DS1302
OBJECT MODULE PLACED IN .\Objects\DS1302.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE DS1302.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\DS
                    -1302.lst) OBJECT(.\Objects\DS1302.obj)

line level    source

   1          // Header: é©±åŠ¨DS1302æ•°å­—æ—¶é’Ÿçš„å‡½æ•°
   2          // File Name: DS1302.c
   3          // Author: ZDXSDU
   4          // Date: Aug.15,2023
   5          #include <REGX52.H>
   6          sbit DS1302_SCLK = P3^6; // DS1302èŠ¯ç‰‡çš„ä¸²è¡Œæ—¶é’Ÿå¼•è„š
   7          sbit DS1302_IO = P3^4; // DS1302èŠ¯ç‰‡çš„ä¸²è¡Œæ•°æ®å¼•è„š
   8          sbit DS1302_CE = P3^5; // DS1302èŠ¯ç‰‡çš„èŠ¯ç‰‡ä½¿èƒ½å¼•è„šï¼ˆé«˜ç”µå¹³æœ‰æ•ˆï¼‰
   9          /**
  10          * @brief DS1302åˆå§‹åŒ–
  11          * @param  æ— 
  12          * @retval æ— 
  13          * @interpretation ç”±äºMCUä¸Šç”µæ—¶I/Oå£å‡ä¸ºé«˜ç”µå¹³ï¼Œéœ€è¦ç»™DS1302çš„æ—¶é’Ÿå’Œä½¿èƒ½å¼•è„šä½ç”µå
             -¹³
  14          */
  15          void DS1302_Init(void)
  16          {
  17   1              DS1302_CE = 0;
  18   1              DS1302_SCLK = 0;
  19   1      }
  20          /**
  21          * @brief å‘DS1302å†™å…¥æ•°æ®
  22          * @param Commandï¼šå‘½ä»¤å­—
  23          * @param Dataï¼šå†™å…¥çš„æ•°æ®å­—èŠ‚
  24          * @retval æ— 
  25          * @interpretation æè¿°
  26          */
  27          void DS1302_WriteByte(unsigned char Command, Data)
  28          {
  29   1              unsigned char i;
  30   1              DS1302_CE = 1; // èŠ¯ç‰‡ä½¿èƒ½å¼•è„šç»™é«˜ç”µå¹³ä½¿å…¶æœ‰æ•ˆ    
  31   1              for(i = 0; i < 8; i++)
  32   1              {
  33   2                      DS1302_IO = Command & (0x01 << i); // å–å‡ºå‘½ä»¤å­—çš„ç¬¬iä½
  34   2                      DS1302_SCLK = 1; // ä¸Šå‡æ²¿å°†æ•°æ®å†™å…¥DS1302
  35   2                      DS1302_SCLK = 0; // æ¢å¤ä¸²è¡Œæ—¶é’Ÿç½®0
  36   2              }
  37   1              for(i = 0; i < 8; i++)
  38   1              {
  39   2                      DS1302_IO = Data & (0x01 << i); // å–å‡ºDataå­—èŠ‚çš„ç¬¬iä½
  40   2                      DS1302_SCLK = 1; // ä¸Šå‡æ²¿å°†æ•°æ®å†™å…¥DS1302
  41   2                      DS1302_SCLK = 0; // æ¢å¤ä¸²è¡Œæ—¶é’Ÿç½®0
  42   2              }
  43   1              DS1302_CE = 0; // å…³é—­èŠ¯ç‰‡ä½¿èƒ½
  44   1      }
  45          /**
  46          * @brief å‘DS1302è¯»å–æ•°æ®
  47          * @param Commandï¼šå‘½ä»¤å­—
  48          * @retval [char]: DS1302è¿”å›çš„æ•°æ®
  49          * @interpretation  æè¿°
  50          */
  51          unsigned char DS1302_ReadByte(unsigned char Command)
  52          {
  53   1              unsigned char i, Data = 0x00;
C51 COMPILER V9.60.7.0   DS1302                                                            08/15/2023 17:06:57 PAGE 2   

  54   1              DS1302_CE = 1; // èŠ¯ç‰‡ä½¿èƒ½å¼•è„šç»™é«˜ç”µå¹³ä½¿å…¶æœ‰æ•ˆ
  55   1              for(i = 0; i < 8; i++)
  56   1              {
  57   2                      DS1302_IO = Command & (0x01 << i); // å–å‡ºå‘½ä»¤å­—çš„ç¬¬iä½
  58   2                      // ç”±äºDS1302çš„å†™å…¥å’Œè¯»å–çš„æ—¶åºä¸ä¸€æ ·ï¼Œè¿™é‡Œéœ€è¦å…ˆç»™0å†ç»™1
  59   2                      DS1302_SCLK = 0; // æ¢å¤ä¸²è¡Œæ—¶é’Ÿç½®0
  60   2                      DS1302_SCLK = 1; // ä¸Šå‡æ²¿å°†æ•°æ®å†™å…¥DS1302
  61   2              }
  62   1              for(i = 0; i < 8; i++)
  63   1              {
  64   2                      // è¿™é‡Œåœ¨å–æ•°æ®çš„æ—¶å€™åˆå°†æ—¶åºåäº†è¿‡æ¥ï¼ŒåŸå› æ˜¯å¦‚æœå…ˆ0å1ä¼šé€ æˆå¤šç»™äº†ä¸€ä¸ª
             -è„‰å†²å‘¨æœŸ
  65   2                      DS1302_SCLK = 1; // æ¢å¤ä¸²è¡Œæ—¶é’Ÿç½®1
  66   2                      DS1302_SCLK = 0; // ä¸‹é™æ²¿è¯»å–DS1302çš„æ•°æ®              
  67   2                      if(DS1302_IO)
  68   2                              Data |= (0x01 << i); // å¦‚æœDS1302çš„è¿”å›å€¼æ˜¯1ï¼Œé‚£ä¹ˆå°±å°†æ¥æ”¶å˜é‡Dataå¯¹åº”ä½ç½®ä¹Ÿå˜æˆ
             -1
  69   2              }
  70   1              DS1302_CE = 0; // å…³é—­èŠ¯ç‰‡ä½¿èƒ½
  71   1              DS1302_IO = 0; // å°†ä¸²è¡Œæ•°æ®å£æ¸…é›¶ï¼Œé˜²æ­¢è¯»å‡ºçš„ä¸å¯¹
  72   1              return Data;
  73   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    167    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
